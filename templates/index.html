<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Scanner</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
        h1 { color: #d9534f; }
        button { padding: 10px 20px; font-size: 16px; margin: 10px; cursor: pointer; }
        input { padding: 5px; font-size: 14px; margin: 5px; }
        #loading { display: none; color: blue; font-size: 18px; }
        #result { font-size: 18px; color: green; margin-top: 10px; }
        #report-links { display: none; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>🔍 Simple Vulnerability Scanner</h1>

    <!-- Button to run an immediate scan -->
    <button onclick="runScan()">Run Scan Now</button>
    <p id="loading">⏳ Scanning... Please wait.</p>

    <br><br>

    <!-- Schedule Scan Section -->
    <h2>⏰ Schedule a Daily Scan</h2>
    <form onsubmit="scheduleScan(event)">
        <input type="text" id="scan_time" placeholder="Enter time (HH:MM, 24-hour format)" required>
        <input type="email" id="email" placeholder="Enter your email address" required>
        <button type="submit">Schedule Scan</button>
    </form>

    <p id="result"></p>

    <!-- Download Report Section -->
    <h2>📂 Download Reports</h2>
    <div id="report-links">
        <a href="/download/pdf" download><button>📄 Download PDF Report</button></a>
        <a href="/download/csv" download><button>📊 Download CSV Report</button></a>
        <a href="/download/json" download><button>📜 Download JSON Report</button></a>
        <a href="/download/html" download><button>🌐 Download HTML Report</button></a>
    </div>

    <script>
        function runScan() {
            document.getElementById("loading").style.display = "block";

            fetch("/run_scan", { method: "POST" })
            .then(response => response.json())
            .then(data => {
                document.getElementById("loading").style.display = "none";
                alert(data.message);
                document.getElementById("report-links").style.display = "block"; // Show report download buttons
            });
        }

        function scheduleScan(event) {
            event.preventDefault();
            let scanTime = document.getElementById("scan_time").value;
            let email = document.getElementById("email").value;

            fetch("/schedule_scan", {
                method: "POST",
                body: new URLSearchParams({ "scan_time": scanTime, "email": email }),
                headers: { "Content-Type": "application/x-www-form-urlencoded" }
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("result").innerText = data.message;
            });
        }
    </script>
</body>
</html>
